<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Minet Tracker App</title>

    <script type="text/javascript" src="/eel.js"></script>

    <link rel="icon" type="image/png" href="css/img/dota2_2.png">

    <link rel="stylesheet" type="text/css" href="css/base.css">
    <link rel="stylesheet" type="text/css" href="css/main.css">
</head>
<body>
    <main>
        <div id="apps">
            <p id="pidr_p">pidr</p>
        </div>
    </main>
</body>

<script>
    // Запрос на файл App.py к функции Get_data()
    async function MakeEelRequest() {
        await eel.Get_data()().then((response) => {
            // Разворачивание json в js объект
            const data = JSON.parse(response);
            console.log(data);

            // Если есть ответ - поменять текст на другой (ответ есть)
            if (data) {
                var q = document.getElementById('pidr_p');
                q.textContent = 'plus in chat!';

                BuildList(data);
            }
            else {
                var q = document.getElementById('pidr_p');
                q.title = 'none((';
            };
        });
    };
    

    // Запуск запроса при загрузке страницы
    window.onload = function() {
        MakeEelRequest();
    };

    // Функция наполнения страницы данными из бд
    async function BuildList(data) {
        const mama = document.getElementById('apps')

        for(var i = 0; i < data.length; i++) {
            const new_div = document.createElement('div');

            // Создаем содержимое
            const appName = document.createTextNode(`App name: ${data[i][2]}`);
            const dateText = document.createTextNode(`Date: ${data[i][1]}`);
            const lineBreak = document.createElement('br');
            
            // Добавляем содержимое в новый div
            new_div.appendChild(appName);
            new_div.appendChild(lineBreak);
            new_div.appendChild(dateText);

            // Стили для нового элемента
            new_div.style.padding = '10px';
            new_div.style.border = '1px solid black';
            new_div.style.borderRadius = '5px';
            new_div.style.margin = '5px';

            // Добавляем новый div в родительский элемент
            mama.appendChild(new_div);
        }
    }
</script>
</html>